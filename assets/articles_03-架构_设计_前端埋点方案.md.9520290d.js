import{_ as s,o as n,c as a,V as l}from"./chunks/framework.b450deef.js";const C=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"articles/03-æ¶æ„/è®¾è®¡/å‰ç«¯åŸ‹ç‚¹æ–¹æ¡ˆ.md","filePath":"articles/03-æ¶æ„/è®¾è®¡/å‰ç«¯åŸ‹ç‚¹æ–¹æ¡ˆ.md"}'),o={name:"articles/03-æ¶æ„/è®¾è®¡/å‰ç«¯åŸ‹ç‚¹æ–¹æ¡ˆ.md"},p=l(`<p>ä¸ºäº†çµæ´»åº¦å’Œæ–¹ä¾¿ï¼Œä¸€èˆ¬é¡¹ç›®ç»“åˆ<code>è‡ªåŠ¨åŸ‹ç‚¹</code>å’Œ<code>æ‰‹åŠ¨åŸ‹ç‚¹</code></p><h2 id="æ‰‹åŠ¨åŸ‹ç‚¹" tabindex="-1">æ‰‹åŠ¨åŸ‹ç‚¹ <a class="header-anchor" href="#æ‰‹åŠ¨åŸ‹ç‚¹" aria-label="Permalink to &quot;æ‰‹åŠ¨åŸ‹ç‚¹&quot;">â€‹</a></h2><p>æ‰‹åŠ¨åŸ‹ç‚¹çš„é‡ç‚¹åº”è¯¥åœ¨äº å£°æ˜å¼ apiå½¢å¼è°ƒç”¨, å¤„ç†å¥½å‚æ•°å¤„ç†å’Œä¸Šé€å³å¯</p><p>è€Œåœ¨ Vue é‡Œåˆ™å¯ä»¥è€ƒè™‘è‡ªå®šä¹‰æŒ‡ä»¤æ¥å°è£…</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * å‘é€è¯·æ±‚ï¼Œä½¿ç”¨imageæ ‡ç­¾è·¨åŸŸ</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * </span><span style="color:#89DDFF;font-style:italic;">@</span><span style="color:#C792EA;font-style:italic;">param</span><span style="color:#676E95;font-style:italic;"> </span><span style="color:#A6ACCD;font-style:italic;">url</span><span style="color:#676E95;font-style:italic;"> æ¥å£åœ°å€</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">sendRequest</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">url</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">page</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">length</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">error</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">è¯·é…ç½®æœ‰æ•ˆçš„pageå‚æ•°</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@burying-point</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">var</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">img</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">Image</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">img</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">src</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">url</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><h2 id="è‡ªåŠ¨åŸ‹ç‚¹" tabindex="-1">è‡ªåŠ¨åŸ‹ç‚¹ <a class="header-anchor" href="#è‡ªåŠ¨åŸ‹ç‚¹" aria-label="Permalink to &quot;è‡ªåŠ¨åŸ‹ç‚¹&quot;">â€‹</a></h2><p>ğŸ¤” åœ¨ vue3 é‡Œç”¨ use çš„å½¢å¼åŸºäºæ‰‹åŠ¨åŸ‹ç‚¹å°è£…é€šç”¨çº§åˆ«çš„åŸ‹ç‚¹ä¹Ÿå¾ˆå®¹æ˜“ = = é‚£è¿˜éœ€è¦è‡ªåŠ¨åŸ‹ç‚¹å…¨æ”¶é›†å—</p><ul><li>é¡µé¢åˆ‡æ¢æ—¶ï¼Œè¿›è¡Œé‡‡é›†ï¼Œå³ url å˜åŒ–æ—¶è§¦å‘çš„äº‹ä»¶ï¼›</li><li>é¡µé¢å¤±å»ç„¦ç‚¹ï¼Œå¾—åˆ°ç„¦ç‚¹æ—¶ï¼Œè¿›è¡Œé‡‡é›†ã€‚å³ focusï¼Œblur äº‹ä»¶ï¼›</li><li>é¡µé¢é€šè¿‡æµè§ˆå™¨ tab åˆ‡æ¢ç¦»å¼€ï¼Œåˆ‡æ¢å›æ¥æ—¶ï¼Œè¿›è¡Œé‡‡é›†ï¼Œå³ visibilitychange äº‹ä»¶ï¼›</li></ul><p>å› ä¸ºå•é¡µå¤šé¡µçš„é¡µé¢ç”Ÿå‘½å‘¨æœŸä¸åŒï¼Œå®ç°è®¿é—®é‡çš„è‡ªåŠ¨åŸ‹ç‚¹çš„è®¾è®¡æ–¹å‘å°±æ˜¯ <code>url</code> çš„å˜åŒ–(å•é¡µå¤šé¡µéƒ½ä¼šå˜åŒ–)</p><ol><li>urlå˜åŒ– = <code>window.location.origin + window.location.pathname + window.location.hash</code> è¿™ä¸‰éƒ¨åˆ†çš„ä»»ä¸€éƒ¨åˆ†å˜åŒ–ï¼Œå³ä¸º url å˜åŒ–ï¼Œå¹¶ä¸åŒ…æ‹¬ <code>window.location.search</code> è¿™éƒ¨åˆ†çš„å˜åŒ–ï¼›</li><li>åœ¨ SPA ä¸­ï¼Œå¦‚æœä¸€ä¸ªé¡µé¢å†…æœ‰å¤šä¸ª tab(åµŒå¥—å­è·¯ç”±)ï¼Œå½“åˆ‡æ¢ tab æ—¶ï¼Œå¼€å‘è€…ä¹Ÿæ”¹å˜ä»–çš„ url çš„ <code>window.location.pathname</code>ï¼Œæ­¤æ—¶ä¹Ÿä¼šè®¤ä¸ºæ˜¯é¡µé¢åˆ‡æ¢ï¼Œä¹Ÿä¼šäº§ç”Ÿä¸ŠæŠ¥æ•°æ®(å¸Œæœ›çš„æ•ˆæœæ˜¯åˆ‡æ¢é¡µé¢å†…çš„Tabä¸å±äºè®¿é—®é‡çš„åŸ‹ç‚¹)</li></ol><p>ğŸ‘‡ <code>history api</code> å¦‚ <code>pushstate,replacestate</code> è‡ªå®šä¹‰äº‹ä»¶ï¼Œå› ä¸º BOM å¹¶æ²¡æœ‰æä¾›ç›¸å…³çš„ api æ”¯æŒ EventListener(ä¼ é€’å›è°ƒæ¥æ”¯æŒæ‹“å±•), éœ€è¦è‡ªè¡Œå°è£…ä½¿ç”¨</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * æ‹¼æ¥é€šç”¨åŒ–ä¸ŠæŠ¥å‚æ•°</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * </span><span style="color:#89DDFF;font-style:italic;">@</span><span style="color:#C792EA;font-style:italic;">param</span><span style="color:#676E95;font-style:italic;"> </span><span style="color:#89DDFF;font-style:italic;">{</span><span style="color:#FFCB6B;font-style:italic;">string</span><span style="color:#89DDFF;font-style:italic;">}</span><span style="color:#676E95;font-style:italic;"> é‡å†™è·¯ç”±äº‹ä»¶ç±»å‹</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">resetHistoryFun</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">type</span><span style="color:#89DDFF;">){</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// å°†åŸå…ˆçš„æ–¹æ³•å¤åˆ¶å‡ºæ¥</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">originMethod</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">history</span><span style="color:#F07178;">[</span><span style="color:#A6ACCD;">type</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// å½“window.history[type]å‡½æ•°è¢«æ‰§è¡Œæ—¶ï¼Œè¿™ä¸ªreturnå‡ºæ¥çš„å‡½æ•°å°±ä¼šè¢«æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">(){</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// æ‰§è¡ŒåŸå…ˆçš„æ–¹æ³•</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">rs</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">originMethod</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">apply</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">arguments</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// ç„¶åè‡ªå®šä¹‰äº‹ä»¶</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">e</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">Event</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">type</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toLocaleLowerCase</span><span style="color:#F07178;">())</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// å°†åŸå…ˆå‡½æ•°çš„å‚æ•°ç»‘å®šåˆ°è‡ªå®šä¹‰çš„äº‹ä»¶ä¸Šå»ï¼ŒåŸå…ˆçš„æ˜¯æ²¡æœ‰çš„</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">arguments</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">arguments</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// ç„¶åç”¨window.dispatchEvent()ä¸»åŠ¨è§¦å‘</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">dispatchEvent</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">e</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">rs</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">history</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">pushState </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">resetHistoryFun</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">pushState</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">) </span><span style="color:#676E95;font-style:italic;">// è¦†ç›–åŸæ¥çš„pushStateæ–¹æ³•</span></span>
<span class="line"><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">history</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">replaceState </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">resetHistoryFun</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">replaceState</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">) </span><span style="color:#676E95;font-style:italic;">// è¦†ç›–åŸæ¥çš„replaceStateæ–¹æ³•</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addEventListener</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">pushstate</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> reportBothEvent)</span></span>
<span class="line"><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addEventListener</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">replacestate</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> reportBothEvent)</span></span></code></pre></div><p>ğŸ‘† å’Œå¾®å‰ç«¯é‡å†™routerçš„æ€è·¯ä¸€æ ·.... å¤šé¡µå‘¢ï¼Ÿurlä¸Šå‚æ•°éƒ¨åˆ†å‘¢? åµŒå¥—å­è·¯ç”±å‘¢?</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addEventListener</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">focus</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">é¡µé¢å¾—åˆ°ç„¦ç‚¹</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addEventListener</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">blur</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">é¡µé¢å¤±å»ç„¦ç‚¹</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addEventListener</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">visibilitychange</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">document</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">hidden</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">é¡µé¢ç¦»å¼€</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">é¡µé¢è¿›å…¥</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>æ•°æ®ä¸ŠæŠ¥æ–¹å¼æ˜¯ <code>XMLHttpRequest</code> <code>window.navigator.sendBeacon</code> åŸºäº h5sdk ä¸ŠæŠ¥é€»è¾‘æ¶æ„ã€‚</p>`,16),e=[p];function t(c,r,y,F,D,i){return n(),a("div",null,e)}const d=s(o,[["render",t]]);export{C as __pageData,d as default};
