import{_ as s,o as a,c as n,V as l}from"./chunks/framework.b450deef.js";const d=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"articles/03-架构/设计/移动端响应式开发单位设计.md","filePath":"articles/03-架构/设计/移动端响应式开发单位设计.md"}'),p={name:"articles/03-架构/设计/移动端响应式开发单位设计.md"},o=l(`<p><a href="https://www.bilibili.com/video/BV1u841157Fh" target="_blank" rel="noreferrer">HTML+CSS 移动端适配方案 -bilibili</a></p><h2 id="移动端显示pc网页" tabindex="-1">移动端显示PC网页 <a class="header-anchor" href="#移动端显示pc网页" aria-label="Permalink to &quot;移动端显示PC网页&quot;">​</a></h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/Viewport_concepts#%E7%A7%BB%E5%8A%A8%E8%AE%BE%E5%A4%87%E7%9A%84%E8%A7%86%E5%8F%A3" target="_blank" rel="noreferrer">视口概念 -MDN</a></p><ul><li>布局视口 layout viewport</li><li>视觉视口 visual layout</li><li>理想视口 ideal layout</li></ul><hr><blockquote><p>🤔 让我们把时间倒回移动设备刚出来的时候，一台手机设备要显示PC网页(各种布局尺寸写死了px)的话，要如何展示？</p></blockquote><p>答案是，想办法等比例缩放网页，网页代码里写死的尺寸也需要被缩放，那么就不是简单的把容器缩放了，还需要对所有尺寸都缩放</p><p>因此px单位的尺寸在移动端都需要被重新计算，也就是<strong>移动端浏览器另外计算尺寸</strong></p><blockquote><p>🤔 那么怎么缩放呢？</p></blockquote><p>无论PC网页多宽都缩放到浏览器宽度，比例是 PC宽度/移动端宽度？</p><ul><li>一个PC网页最终的宽度也是未知的，只有PC浏览器运行了才知道</li><li>因此移动端浏览器也不知道PC网页的宽度</li><li>而假设直接把PC网页宽度设置为移动端设备的宽度的话</li><li>各种px布局尺寸会乱版</li></ul><p>希望保持PC网页在PC浏览器那样的布局而只是缩放大小的话</p><ul><li>移动端浏览器就需要设置一个假想的PC网页宽度</li><li>把PC网页放在这个宽度里布局后</li><li>再按照移动端宽度等比例缩放网页</li></ul><hr><p>👆 根据我们的思考设计</p><p>移动端浏览器需要对所有网页设置一个假想的网页宽度 根据设备的不同，有可能是<code>768px</code>、<code>980px</code>或<code>1024px</code>等 通过浏览器api可以获取 <code>document.documentElement.clientWidth/clientHeight</code></p><p>👇 这个宽度就是<code>布局视口 layout viewport</code><img src="https://kingan-md-img.oss-cn-guangzhou.aliyuncs.com/blog/20221205134812.png" alt=""></p><p>再按移动端设备宽度等比例缩放网页 通过浏览器api可以获取 <code>window.innerWidth/innerHeight</code> 👇 这个移动端设备宽度就是 <code>视觉视口 visual layout</code></p><p><img src="https://kingan-md-img.oss-cn-guangzhou.aliyuncs.com/blog/20221205134825.png" alt=""></p><p>另外假设我们只针对某个设备宽度开发一个网页 这个网页不需要移动端浏览器来重新计算我们的尺寸</p><p>这种开发就是针对一个移动设备的<code>理想视口 ideal layout</code>进行的 👇 也就是<code>理想视口</code>，不同于<code>布局视口</code>和<code>视觉视口</code>是个更概念的概念</p><p><img src="https://kingan-md-img.oss-cn-guangzhou.aliyuncs.com/blog/20221205134836.png" alt=""></p><p>虽然👆的设计帮我们自动适配了移动端显示PC网页</p><p>但是这并不是适合移动端的交互方式 直接缩放页面会导致页面字体变小，使得缩放后的页面显示效果都不会很理想 因此当我们网页是纯移动端时，并不希望用移动端浏览器默认为我们做重新计算单位 而是让它保持原尺寸并且网页宽度为移动端设备宽度，即使乱版</p><h2 id="meta的viewport" tabindex="-1">meta的viewport <a class="header-anchor" href="#meta的viewport" aria-label="Permalink to &quot;meta的viewport&quot;">​</a></h2><p>👇 我们写一个干净的HTML</p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;!</span><span style="color:#F07178;">DOCTYPE</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">html</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">html</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">head</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">title</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">Document</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">title</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">head</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">  &lt;</span><span style="color:#F07178;">style</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">test</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#B2CCD6;">width</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">100px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#B2CCD6;">height</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">100px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#B2CCD6;">background-color</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">#</span><span style="color:#A6ACCD;">ccc</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">style</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">body</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">class</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">test</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">100px*100px</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">body</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">html</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div><p><img src="https://kingan-md-img.oss-cn-guangzhou.aliyuncs.com/blog/112.gif" alt=""></p><p>👆 切换移动端/PC端，会发现选中元素都显示是100px，但是视觉上尺寸切换明显不一样</p><p>这就是移动端为了显示PC网页所做的等比例缩放处理，并且是<strong>默认处理的</strong></p><p>就像我们说的<strong>这并不是适合纯移动端网页的交互方式</strong></p><p>💻 我们需要关闭浏览器默认对网页缩放的处理</p><ul><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/meta" target="_blank" rel="noreferrer">html的元数据元素mate -MDN</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/meta/name" target="_blank" rel="noreferrer">meta中的name -MDN</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Viewport_meta_tag" target="_blank" rel="noreferrer">Using the viewport meta tag to control layout on mobile browsers (en-US)</a></li></ul><p>了解了 👆 <code>HTML</code> 对 <code>meta</code> 元信息的设计 CSS 设备适配规范（<code>CSS Device Adaptation specification</code>）定义了 <code>name</code> 为 <code>viewport</code> 元数据名称，并且这个属性目前仅在移动设备上生效</p><p>👇 这是 <code>vscode</code> 自动生成的 <code>html</code> 模板 <img src="https://kingan-md-img.oss-cn-guangzhou.aliyuncs.com/blog/20221205132501.png" alt=""></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">meta</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">name</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">viewport</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">content</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">width=device-width, initial-scale=1.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div><p>👆 我们看到只针对移动端生效的 <code>meta</code> 配置了两个属性 <code>width</code> <code>initial-scale</code></p><h2 id="viewport-中的-width" tabindex="-1">viewport 中的 width <a class="header-anchor" href="#viewport-中的-width" aria-label="Permalink to &quot;viewport 中的 width&quot;">​</a></h2><blockquote><p>定义 <code>viewport</code> 的宽度，如果值为正整数，则单位为像素。 正整数，或字符串 <code>‘device-width’</code></p></blockquote><p>这个宽度就是上面 <a href="#移动端显示pc网页">移动端显示PC网页</a>中的假想PC网页宽度 <code>布局视口layout viewport</code></p><p>默认值根据设备的不同，有可能是768px、980px或1024px等</p><p><strong>这个值的大小影响网页布局后缩放的尺寸</strong></p><p>假设我们设置布局视口宽度为<code>100px</code> 里面的<code>100px</code>方块就会铺满<code>100px</code>，再进行缩放的效果将会是铺满的 <img src="https://kingan-md-img.oss-cn-guangzhou.aliyuncs.com/blog/webcomponents2.gif" alt=""></p><p>👆 设置了 <code>&lt;meta name=&quot;viewport&quot; content=&quot;width=100&quot;&gt;</code></p><ul><li>但是指定具体的宽度值，并不能适配所有的移动设备尺寸</li><li>这里有个特殊的值 <code>‘device-width’</code></li><li>动态设置视口宽度为设备宽度</li></ul><p>👆 这就是我们希望关闭浏览器默认对网页缩放的处理(就是缩放前后比例相等)，这也是 <code>vscode</code> 为我们默认生成的模版中的值</p><p>效果上：不同的设备显示的方块大小将会一样，无论设备大小都不会缩放</p><h2 id="viewport-中的-initial-scale" tabindex="-1">viewport 中的 initial-scale <a class="header-anchor" href="#viewport-中的-initial-scale" aria-label="Permalink to &quot;viewport 中的 initial-scale&quot;">​</a></h2><blockquote><p>定义设备宽度（宽度和高度中更小的那个：如果是纵向屏幕，就是 <code>device-width</code>，如果是横向屏幕，就是 <code>device-height</code>）与 <code>viewport</code> 大小之间的缩放比例。 <code>0.0</code> 和 <code>10.0</code> 之间的正数 默认值 <code>1.0</code></p></blockquote><p>👆 会在移动端自动缩放的基础上再缩放一次，默认值就是 <code>1.0</code> 不缩放</p><p>但是这个值是移动端浏览器处理的，当不设置的时候，有可能会被浏览器设置成别的缩放值，如PC浏览器设置里可以设置默认缩放比</p><p>因此保险起见，手动设置成 <code>1.0</code> 这也是 <code>vscode</code> 为我们默认生成的模版中的考虑</p><h2 id="viewport-禁止移动端缩放网页" tabindex="-1">viewport 禁止移动端缩放网页 <a class="header-anchor" href="#viewport-禁止移动端缩放网页" aria-label="Permalink to &quot;viewport 禁止移动端缩放网页&quot;">​</a></h2><p><code>&lt;meta name=&quot;viewport&quot; content=&quot;user-scalable=no&quot;&gt;</code></p><blockquote><p>设置为 no，用户将无法缩放当前页面 浏览器设置可以忽略此规则；iOS 10 开始，Safari iOS 默认忽略此规则 默认为 yes</p></blockquote><p>一般纯移动端网页也不希望被人缩放导致乱版</p><h2 id="移动端显示纯移动端网页" tabindex="-1">移动端显示纯移动端网页 <a class="header-anchor" href="#移动端显示纯移动端网页" aria-label="Permalink to &quot;移动端显示纯移动端网页&quot;">​</a></h2><p>经过 👆 关闭浏览器默认对网页缩放的处理 <code>&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width&quot;&gt;</code> 我们得到了一个无论设备大小都不会缩放的布局容器</p><p>但是我们希望不同移动端设备还是能根据设备不同有一点缩放处理</p><hr><blockquote><p>🤔 既然我们有能力设置决定缩放比例的视口宽度，为什么不把布局视口设置成<code>750/375px</code>，然后代码CSS写相应的布局视口下的尺寸呢</p></blockquote><p>经过浏览器自动的缩放不是也能实现不同移动端适配的效果吗？</p><p><img src="https://kingan-md-img.oss-cn-guangzhou.aliyuncs.com/blog/webcomponents3.gif" alt=""></p><p>👆 我们把视口宽度设置为 <code>375</code>，设置方块宽高为 <code>187.5</code> ,也就是屏幕的一半</p><p>拉伸设备宽度可以看到始终保持设备的一半，这不就是我们希望实现的不同设备适配了吗?</p><p>而且按照375编写的css尺寸，在PC浏览器上也会是希望的375尺寸(视口宽度只在移动端生效)</p><p>🤯 为什么啊？利用浏览器自动缩放实现不同设备不好吗？为什么要把移动端适配搞得这么复杂啊！</p><p>缺点是不能局部控制不缩放，比如1px希望所有设备都是1px不缩放（其他方案也是通过特殊处理1px不缩放的</p><p>那设置viewport的方案也可以特殊处理1px吧，比如说伪元素</p><h2 id="移动端开发适配不同尺寸方案" tabindex="-1">移动端开发适配不同尺寸方案 <a class="header-anchor" href="#移动端开发适配不同尺寸方案" aria-label="Permalink to &quot;移动端开发适配不同尺寸方案&quot;">​</a></h2><p>不依赖浏览器自动对所有尺寸做的缩放，而是我们自己决定所有尺寸的缩放</p><p>因此着手的地方就是每个写尺寸的地方 写成<code>rem/vw</code>这种动态的单位</p><h2 id="vw" tabindex="-1">vw <a class="header-anchor" href="#vw" aria-label="Permalink to &quot;vw&quot;">​</a></h2><p>按视觉视口(设备宽度)为<code>375px</code>，那么 <code>1vw = 3.75px</code> ，这时UI给定一个元素的宽为75px（设备独立像素），我们只需要将它设置为 <code>75 / 3.75 = 20vw</code></p><p><code>设计稿总宽度px / 100vw = 目标样式px / 得出的vw</code></p><p><code>得出的vw = 目标样式px / (设计稿总宽度px / 100vw)</code></p><p>👇 scss</p><div class="language-scss"><button title="Copy Code" class="copy"></button><span class="lang">scss</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">@vv = 375/100</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">@function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">vw</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">$px</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;font-style:italic;">@return</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">$px </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;"> @vv</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> vw</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">class-name</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#B2CCD6;">width</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">vw</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">187.5</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>👇 css</p><div class="language-css"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">root </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  --vv </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">calc</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">375</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">100</span><span style="color:#89DDFF;">);</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">/* 不能写单位 */</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">class-name</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#B2CCD6;">width</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">calc</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">187.5vw</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">var</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">--vv</span><span style="color:#89DDFF;">));</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">/* 要写单位vw */</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><h2 id="rem" tabindex="-1">rem <a class="header-anchor" href="#rem" aria-label="Permalink to &quot;rem&quot;">​</a></h2><p>把设计稿总宽度375，分为 100rem 则样式css187.5px，占50rem</p><ul><li><code>设计稿总宽度px / 100 = 目标样式px / 得出的rem</code></li><li><code>得出的rem = 目标样式px / (设计稿总宽度px / 100)</code></li></ul><p>👆 其实和vw的做法相同，需要编写css函数来计算</p><p>👇 另外还要做的是把1rem对应的尺寸得出来</p><ul><li><code>设备宽度/100 = 1rem = 根元素font-size</code></li></ul><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">html</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">head</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">meta</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">name</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">viewport</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">content</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">width=device-width, initial-scale=1.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> &gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">head</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">style</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#FFCB6B;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#B2CCD6;">padding</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#B2CCD6;">margin</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  --vv </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">calc</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">375</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">100</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#FFCB6B;">body</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#B2CCD6;">font-size</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">16px</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">/* 还原文字默认大小 */</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">test</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#B2CCD6;">width</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">calc</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">187.5rem</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">var</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">--vv</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#B2CCD6;">height</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">187.5px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#B2CCD6;">background-color</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">#</span><span style="color:#A6ACCD;">ccc</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">style</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">setRem</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">deviceWidth</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">innerWidth</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">htmlEl</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">document</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">documentElement</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 将设备宽度分为100份，作为1rem的大小 font-size</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">htmlEl</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">style</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">fontSize</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">deviceWidth</span><span style="color:#89DDFF;">/</span><span style="color:#F78C6C;">100</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">px</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 第一次进入页面调用</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">setRem</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  window</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addEventListener</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">resize</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> setRem)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">body</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">class</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">test</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">187.5*187.5</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">body</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">html</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div><p>因为<code>1rem</code>对应多少由我们决定，因此我们可以让<code>1rem</code>等于设计稿的\`\`1px</p><p>可以想办法让开发直接写<code>rem</code>,而减少写<code>css函数</code>的繁琐</p><p>如<code>375</code>的设计稿，<code>187.5px</code>的样式css，开发代码可以写成 <code>width: 187.5rem</code></p><p>而不是 <code>width: calc(187.5rem / var(--vv))</code></p><p>👇 设计稿<code>375px</code>，<code>1rem</code>为<code>1px</code><code>设备宽度/设计稿宽度 = 1rem = 根元素font-size</code></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">setRem</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">deviceWidth</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">innerWidth</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">htmlEl</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">document</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">documentElement</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 将设备宽度氛围设计稿宽度的份数，使设计稿1px对应1rem font-size</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">htmlEl</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">style</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">fontSize</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">deviceWidth</span><span style="color:#89DDFF;">/</span><span style="color:#F78C6C;">375</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">px</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#82AAFF;">setRem</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addEventListener</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">resize</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> setRem)</span><span style="color:#89DDFF;">;</span></span></code></pre></div><h2 id="_1px问题" tabindex="-1">1px问题 <a class="header-anchor" href="#_1px问题" aria-label="Permalink to &quot;1px问题&quot;">​</a></h2><blockquote><p>1px问题也就是有时候希望样式尺寸不缩放，如1px的边框在无论大小的设备上都是一样的大小</p></blockquote><p>在<code>vw</code>和<code>rem</code>的方案里</p><ul><li>不用<code>css函数</code>和<code>rem</code>单位写的尺寸</li><li>用<code>px</code>写尺寸就实现了不缩放的尺寸</li></ul><p>这个问题更多的是针对使用<code>webpack编译插件</code>扫描<code>所有px</code>转化为<code>vw/rem</code>导致的全局缩放问题</p><p>这些插件都有相应的配置项，设置如<code>大于2px</code>才转化为<code>vw/rem</code></p><p>🤔 问题是如果用的<code>viewport width=设计稿宽度</code>，利用移动端浏览器自动缩放的方案</p><p>所有px都会被自动缩放，没办法局部设置不缩放</p><h2 id="_0-5px问题" tabindex="-1">0.5px问题 <a class="header-anchor" href="#_0-5px问题" aria-label="Permalink to &quot;0.5px问题&quot;">​</a></h2><p><code>0.5px</code>问题不属于移动端适配的问题，这里作为题外话</p><p>设计稿中有时会有</p><ul><li>750设计稿1px</li><li>375设计稿0.5px</li></ul><p>👆的需求</p><p>而浏览器不支持1以下的px，有些浏览器会当作<code>1px</code>显示，有些浏览器会不显示</p><p>因此假如要实现这种<code>0.5px</code></p><p>需要绘制不被缩放的<code>1px</code>，利用css的缩放，缩小一半来实现</p><h2 id="物理像素" tabindex="-1">物理像素 <a class="header-anchor" href="#物理像素" aria-label="Permalink to &quot;物理像素&quot;">​</a></h2><p>名词</p><ul><li>抽象像素 - 代码CSS像素</li><li>设备物理像素 - 宽高像素值(随设备不同变化)</li><li>设备独立像素 - CSS1px对应的物理像素(随设备不同变化)</li></ul><p>代码css设置的1px并不是真实的设备上的1像素 而是运行时根据设备的物理像素和CSS像素的比例计算出来的物理像素，如 显示物理像素 = 代码CSS像素 * (设备物理像素和设备独立像素的比例)</p><p>👇 PC浏览器调试模式下，iphone6的设备尺寸 <img src="https://kingan-md-img.oss-cn-guangzhou.aliyuncs.com/blog/20221205171857.png" alt=""></p><p>这里的375px并不是iphone6的物理像素，而是设备独立像素 而<a href="https://experienceleague.adobe.com/docs/target/using/experiences/vec/mobile-viewports.html" target="_blank" rel="noreferrer">查询</a>到设备物理像素是750px 也就是1个CSS像素对应2个物理像素 👆 这就是我们要的比例</p><p>而浏览器有提供相应的api给我们获取 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/devicePixelRatio" target="_blank" rel="noreferrer">devicePixelRatio -MDN</a></p><blockquote><p>返回当前显示设备的物理像素分辨率与CSS 像素分辨率之比 此值也可以解释为像素大小的比率：一个 CSS 像素的大小与一个物理像素的大小 简单来说，它告诉浏览器应使用多少屏幕实际像素来绘制单个 CSS 像素</p></blockquote><p><code>console.log(window.devicePixelRatio)</code>输出了2，即375对应750物理像素</p><p>👇 常见的设备像素比：</p><ul><li>普通密度桌面显示屏：devicePixelRatio = 1</li><li>高密度桌面显示屏(Mac Retina)：devicePixelRatio = 2</li><li>主流手机显示屏：devicePixelRatio = 2 or 3</li></ul><p>决定我们使用几倍图会清晰</p><h2 id="lib-flexible-js" tabindex="-1">lib-flexible.js <a class="header-anchor" href="#lib-flexible-js" aria-label="Permalink to &quot;lib-flexible.js&quot;">​</a></h2><p><a href="https://github.com/amfe/lib-flexible/blob/2.0/index.js" target="_blank" rel="noreferrer">lib-flexible -github</a></p><h3 id="_1-🔧-工具库代码结构上是立即执行函数iife" tabindex="-1">1. 🔧 工具库代码结构上是立即执行函数IIFE <a class="header-anchor" href="#_1-🔧-工具库代码结构上是立即执行函数iife" aria-label="Permalink to &quot;1. 🔧 工具库代码结构上是立即执行函数IIFE&quot;">​</a></h3><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">flexible</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">window</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">document</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// ...</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">(window</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> document))</span></span></code></pre></div><p>👆 我们可以马上联想到其他直接通过<code>&lt;script&gt;</code>标签引入的第三方库</p><p>如 <a href="./../vue/重学vue-01模板语法.html#模块化的形式">vue.min.js当中的模块化</a></p><p>但是这里的 <code>window</code>、<code>document</code> 参数没必要传递吧 如模块化文章中，参数一般用于在<code>UMD</code>中区分全局变量环境使用 也就是传递进一个this的话，适合这样传</p><p>但是这个🔧工具函数的使用场景只有浏览器 👇 感觉用普通立即执行函数就可以了</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">()</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// ...</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)()</span></span></code></pre></div><hr><p>🤔 为什么要用立即执行函数，引入一个js不是本来就会立即执行吗？</p><p>因为直接引入的js作用域是全局的，会造成变量污染，用闭包包住后，变量不会影响其他js</p><h3 id="_2-立即设置1rem的font-size并且监听窗口事件" tabindex="-1">2. 立即设置1rem的font-size并且监听窗口事件 <a class="header-anchor" href="#_2-立即设置1rem的font-size并且监听窗口事件" aria-label="Permalink to &quot;2. 立即设置1rem的font-size并且监听窗口事件&quot;">​</a></h3><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> docEl </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> document</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">documentElement</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// set 1rem = viewWidth / 10</span></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">setRemUnit</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">var</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">rem</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">docEl</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">clientWidth</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">/</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">10</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">docEl</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">style</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">fontSize</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">rem</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">px</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">setRemUnit</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addEventListener</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">resize</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> setRemUnit)</span></span></code></pre></div><h3 id="_3-还原默认字体大小" tabindex="-1">3. 还原默认字体大小 <a class="header-anchor" href="#_3-还原默认字体大小" aria-label="Permalink to &quot;3. 还原默认字体大小&quot;">​</a></h3><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// adjust body font size</span></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">setBodyFontSize</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">document</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">body</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">document</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">body</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">style</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">fontSize</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> (</span><span style="color:#F78C6C;">12</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">*</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">dpr</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">px</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addEventListener</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">DOMContentLoaded</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">setBodyFontSize</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#82AAFF;">setBodyFontSize</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">;</span></span></code></pre></div><h3 id="_4-处理跳转第三方网页调整大小后返回不触发重新计算问题-监听返回" tabindex="-1">4. 处理跳转第三方网页调整大小后返回不触发重新计算问题-监听返回 <a class="header-anchor" href="#_4-处理跳转第三方网页调整大小后返回不触发重新计算问题-监听返回" aria-label="Permalink to &quot;4. 处理跳转第三方网页调整大小后返回不触发重新计算问题-监听返回&quot;">​</a></h3><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/pageshow_event" target="_blank" rel="noreferrer">pageshow -MDN</a></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addEventListener</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">pageshow</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">e</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">persisted</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">setRemUnit</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><h3 id="_5-判断设备支不支持0-5px" tabindex="-1">5. 判断设备支不支持0.5px <a class="header-anchor" href="#_5-判断设备支不支持0-5px" aria-label="Permalink to &quot;5. 判断设备支不支持0.5px&quot;">​</a></h3><p>👇 <a href="#物理像素">设备像素比</a> 大于等于2 并且 两条0.5px占文档流1px偏移量</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> docEl </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> document</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">documentElement</span></span>
<span class="line"><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> dpr </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> window</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">devicePixelRatio </span><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 测试 0.5px supports</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> (dpr </span><span style="color:#89DDFF;">&gt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">) </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// 设备像素比大于等于2</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">var</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">fakeBody</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createElement</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">body</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">var</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">testElement</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createElement</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">div</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">testElement</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">style</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">border</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.5px solid transparent</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">fakeBody</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">appendChild</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">testElement</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">docEl</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">appendChild</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">fakeBody</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 两条0.5px占文档流1px偏移量</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">testElement</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">offsetHeight</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">docEl</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">classList</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">add</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hairlines</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">) </span><span style="color:#676E95;font-style:italic;">// 往全局dom添加一个 \`hairlines\` 的 className</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">docEl</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">removeChild</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">fakeBody</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>👆 只是往全局dom添加了一个 <code>hairlines</code> 的 <code>className</code></p><p>🤔 TODO: 并不会做什么操作，这个className要用来做什么</p><p>设置一个css变量不是更好用吗？ 如 <code>--hair-unit = 0.5 or 1</code>，使用时设备支持则显示 <code>0.5px</code> 不支持则显示 <code>1px</code></p><h2 id="参考资料" tabindex="-1">参考资料 <a class="header-anchor" href="#参考资料" aria-label="Permalink to &quot;参考资料&quot;">​</a></h2><ul><li><a href="https://zhuanlan.zhihu.com/p/339303865" target="_blank" rel="noreferrer">移动端适配viewport缩放方案</a></li><li><a href="https://juejin.cn/post/7085931616136069156" target="_blank" rel="noreferrer">https://juejin.cn/post/7085931616136069156</a></li></ul>`,148),e=[o];function t(c,r,y,D,F,i){return a(),n("div",null,e)}const A=s(p,[["render",t]]);export{d as __pageData,A as default};
