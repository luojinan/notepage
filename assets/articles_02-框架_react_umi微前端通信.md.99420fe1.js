import{_ as s,o as a,c as n,V as l}from"./chunks/framework.b450deef.js";const C=JSON.parse('{"title":"umi qiankun å¾®å‰ç«¯é€šä¿¡","description":"","frontmatter":{},"headers":[],"relativePath":"articles/02-æ¡†æ¶/react/umiå¾®å‰ç«¯é€šä¿¡.md","filePath":"articles/02-æ¡†æ¶/react/umiå¾®å‰ç«¯é€šä¿¡.md"}'),o={name:"articles/02-æ¡†æ¶/react/umiå¾®å‰ç«¯é€šä¿¡.md"},p=l(`<h1 id="umi-qiankun-å¾®å‰ç«¯é€šä¿¡" tabindex="-1">umi qiankun å¾®å‰ç«¯é€šä¿¡ <a class="header-anchor" href="#umi-qiankun-å¾®å‰ç«¯é€šä¿¡" aria-label="Permalink to &quot;umi qiankun å¾®å‰ç«¯é€šä¿¡&quot;">â€‹</a></h1><p><a href="https://umijs.org/zh-CN/plugins/plugin-qiankun" target="_blank" rel="noreferrer">@umijs/plugin-qiankun</a></p><blockquote><p>é…åˆ <a href="https://umijs.org/zh-CN/plugins/plugin-model" target="_blank" rel="noreferrer">useModel</a> ä½¿ç”¨ï¼ˆæ¨èï¼‰</p></blockquote><blockquote><p>éœ€ç¡®ä¿å·²å®‰è£… <code>@umijs/plugin-model</code> æˆ– <code>@umijs/preset-react</code></p></blockquote><p>å› ä¸ºæ–‡æ¡£æ¨èçš„é€šä¿¡æ–¹å¼æ˜¯ <code>@umijs/plugin-model</code></p><p>ä½†æ˜¯ <code>package.json</code> æ²¡æœ‰çœ‹åˆ°å®‰è£…ï¼Œä»¥ä¸ºä¸èƒ½ç”¨</p><p>ç»“æœçœ‹åˆ°å…¥å£ <code>app.tsx</code> å¯¼å‡ºçš„ <code>getInitialState</code> ä½¿ç”¨åˆ° <a href="https://v3.umijs.org/zh-CN/plugins/plugin-initial-state" target="_blank" rel="noreferrer">@umijs/plugin-initial-state</a></p><p><img src="https://kingan-md-img.oss-cn-guangzhou.aliyuncs.com/blog/20230523171737.png" alt=""></p><blockquote><p><strong>è¿™ä¸ªæ’ä»¶ä¸å¯ç›´æ¥ä½¿ç”¨ï¼Œå¿…é¡»æ­é… @umijs/plugin-model ä¸€èµ·ä½¿ç”¨</strong>ã€‚</p></blockquote><p>ä¹Ÿå°±å‡ºè¯´é¡¹ç›®å·²ç»æœ‰åœ¨ç”¨äº†ï¼Œåªæ˜¯çœ‹ä¸åˆ°...</p><h2 id="umijs-plugin-model" tabindex="-1">@umijs/plugin-model <a class="header-anchor" href="#umijs-plugin-model" aria-label="Permalink to &quot;@umijs/plugin-model&quot;">â€‹</a></h2><blockquote><p>çº¦å®šåœ¨ <code>src/models</code> ç›®å½•ä¸‹çš„æ–‡ä»¶ä¸ºé¡¹ç›®å®šä¹‰çš„ <code>model</code> æ–‡ä»¶</p></blockquote><blockquote><p>æ¯ä¸ªæ–‡ä»¶éœ€è¦é»˜è®¤å¯¼å‡ºä¸€ä¸ª <code>function</code>ï¼Œè¯¥ <code>function</code> å®šä¹‰äº†ä¸€ä¸ª <code>Hook</code>ï¼Œä¸ç¬¦åˆè§„èŒƒçš„æ–‡ä»¶æˆ‘ä»¬ä¼šè¿‡æ»¤æ‰ã€‚</p></blockquote><p><img src="https://kingan-md-img.oss-cn-guangzhou.aliyuncs.com/blog/20230523171658.png" alt=""></p><p>ğŸ‘‡ <code>src/models/xxx.js</code></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">useState</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">react</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">useUser</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">user</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">setUser</span><span style="color:#89DDFF;">]</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">useState</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">null</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">user</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">setUser</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p><code>models</code> ç›®å½•ä¸‹çš„æ–‡ä»¶åä½œä¸º <code>state</code> çš„ <code>nameSpace</code></p><p>ğŸ‘‡ é€šè¿‡æ’ä»¶(å®‰è£…åéƒ½ä» <code>umi</code> ä¸­å¼•å…¥) <code>useModel(nameSpace)</code> ä½¿ç”¨</p><div class="language-jsx"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">useModel</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">umi</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">user</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">setUser</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">useModel</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">xxx</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">user</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><h2 id="umijs-plugin-qiankun" tabindex="-1">@umijs/plugin-qiankun <a class="header-anchor" href="#umijs-plugin-qiankun" aria-label="Permalink to &quot;@umijs/plugin-qiankun&quot;">â€‹</a></h2><h3 id="å¾®åº”ç”¨" tabindex="-1">å¾®åº”ç”¨ <a class="header-anchor" href="#å¾®åº”ç”¨" aria-label="Permalink to &quot;å¾®åº”ç”¨&quot;">â€‹</a></h3><blockquote><p>å¾®åº”ç”¨ä¸­ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªå…¨å±€ modelï¼Œå¯ä»¥åœ¨ä»»æ„ç»„ä»¶ä¸­è·å–ä¸»åº”ç”¨é€ä¼ çš„ props çš„å€¼ã€‚</p></blockquote><p>ğŸ‘† å…¨å±€ <code>model</code> çš„ <code>nameSpace</code> æ˜¯ <code>@@qiankunStateFromMaster</code></p><p>âœ¨ è¿™é‡Œçš„ <code>nameSpace</code> ç­‰åŒäº ä¸Šé¢ <code>@umijs/plugin-model</code> çº¦å®šåœ¨ <code>src/models</code> ç›®å½•ä¸‹çš„æ–‡ä»¶ä¸ºé¡¹ç›®å®šä¹‰çš„ <code>model</code> æ–‡ä»¶</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">useModel</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">umi</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">MyPage</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">masterProps</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">useModel</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@@qiankunStateFromMaster</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><h3 id="ä¸»åº”ç”¨" tabindex="-1">ä¸»åº”ç”¨ <a class="header-anchor" href="#ä¸»åº”ç”¨" aria-label="Permalink to &quot;ä¸»åº”ç”¨&quot;">â€‹</a></h3><blockquote><p>åœ¨ <code>src/app.ts</code> é‡Œå¯¼å‡ºä¸€ä¸ª <code>useQiankunStateForSlave</code> å‡½æ•°ï¼Œå‡½æ•°çš„è¿”å›å€¼å°†ä½œä¸º props ä¼ é€’ç»™å¾®åº”ç”¨</p></blockquote><p>ğŸ‘‡ <code>src/app.ts</code></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">useQiankunStateForSlave</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">masterState</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">setMasterState</span><span style="color:#89DDFF;">]</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">useState</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    showFlag</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">false</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// &lt;-- âœ¨ è®¾ç½®åˆå§‹å€¼</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">masterState</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">setMasterState</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><h2 id="é€šä¿¡" tabindex="-1">é€šä¿¡ <a class="header-anchor" href="#é€šä¿¡" aria-label="Permalink to &quot;é€šä¿¡&quot;">â€‹</a></h2><p>å› ä¸ºç¯å¢ƒ(æ’ä»¶ä¾èµ–<code>@umijs/plugin-qiankunã€@umijs/plugin-model</code>)å·²ç»å®Œå–„</p><p>ç›´æ¥ä¸»åº”ç”¨å…¥å£å®šä¹‰å¹¶å¯¼å‡º <code>useQiankunStateForSlave()</code> ğŸ‘‡ <code>src/app.ts</code></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">useQiankunStateForSlave</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">masterState</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">setMasterState</span><span style="color:#89DDFF;">]</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">useState</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    showFlag</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">false</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// &lt;-- âœ¨ è®¾ç½®åˆå§‹å€¼</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">masterState</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">setMasterState</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>å­åº”ç”¨ç¯å¢ƒ(æ’ä»¶ä¾èµ–<code>@umijs/plugin-model</code>)åŒæ ·å·²ç»å®Œå–„</p><p>ğŸ‘‡ ç›´æ¥åœ¨ä¸šåŠ¡é¡µé¢ç»„ä»¶ä¸­è°ƒç”¨ä¿®æ”¹çŠ¶æ€çš„ <code>set</code> å‡½æ•°</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">useModel</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">umi</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Page1</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">masterState</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">setMasterState</span><span style="color:#89DDFF;">}=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">useModel</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@@qiankunStateFromMaster</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">setMasterState</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">showFlag</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">) </span><span style="color:#676E95;font-style:italic;">// &lt;-- âœ¨ ä¿®æ”¹showFlagä¸ºtrue</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>ğŸ‘† å³å¯ä½¿ä¸»åº”ç”¨çš„ <code>showFlag</code> å˜ä¸º <code>true</code> è§¦å‘ä¸»åº”ç”¨ç»„ä»¶æ›´æ–°æ¸²æŸ“</p><h2 id="å­åº”ç”¨ç‹¬ç«‹è¿è¡Œæ—¶çš„çŠ¶æ€æ§åˆ¶" tabindex="-1">å­åº”ç”¨ç‹¬ç«‹è¿è¡Œæ—¶çš„çŠ¶æ€æ§åˆ¶ <a class="header-anchor" href="#å­åº”ç”¨ç‹¬ç«‹è¿è¡Œæ—¶çš„çŠ¶æ€æ§åˆ¶" aria-label="Permalink to &quot;å­åº”ç”¨ç‹¬ç«‹è¿è¡Œæ—¶çš„çŠ¶æ€æ§åˆ¶&quot;">â€‹</a></h2><p>å› ä¸ºåŒæ—¶éœ€è¦è€ƒè™‘å­åº”ç”¨ç‹¬ç«‹è¿è¡Œæ—¶çš„çŠ¶æ€ç®¡ç†</p><p>å› æ­¤å­åº”ç”¨é¡µé¢ä¿®æ”¹çŠ¶æ€éœ€è¦åŒºåˆ†ä¸€ä¸‹è¿è¡Œç¯å¢ƒï¼š</p><ul><li>å½“è¿è¡Œåœ¨ <code>qiankun</code> å¾®å‰ç«¯å®¹å™¨æ—¶ï¼Œåˆ™ä¿®æ”¹ä¸»åº”ç”¨çš„ <code>state</code></li><li>å½“ç‹¬ç«‹è¿è¡Œæ—¶ï¼Œåˆ™ä¿®æ”¹å­åº”ç”¨é¡¹ç›®çš„ <code>state</code></li></ul><p>å°è¯•å­åº”ç”¨åˆ›å»º <code>src/models/@@qiankunStateFromMaster.js</code> ä¸ä¾µå…¥ä¸šåŠ¡ä»£ç ï¼Œç”± <code>umi</code> è‡ªåŠ¨è¯†åˆ«ä¼˜å…ˆçº§ï¼š</p><ul><li>å­åº”ç”¨ç‹¬ç«‹è¿è¡Œæ—¶ï¼Œæ— ä¸»åº”ç”¨æ³¨å…¥çš„å…¨å±€ <code>state</code>ï¼Œä½¿ç”¨æœ¬åœ°é¡¹ç›®çš„ <code>src/models</code></li><li>å­åº”ç”¨è¿è¡Œåœ¨å¾®å‰ç«¯å®¹å™¨æ—¶ï¼Œè‡ªåŠ¨æ— è§†å­åº”ç”¨é¡¹ç›®åˆ›å»ºçš„ <code>state</code>ï¼Œä½¿ç”¨ä¸»åº”ç”¨çš„ <code>state</code></li></ul><p>å°è¯•å¤±è´¥ âŒï¼Œ <code>@umijs/plugin-model</code> ä¸å…è®¸ä½¿ç”¨ <code>@@qiankunStateFromMaster</code>ã€<code>@@initialState</code> åšæ–‡ä»¶å(<code>nameSpace</code>)</p><p>é‚£å°±åªèƒ½ä¾µå…¥ä¸šåŠ¡ä»£ç ï¼Œè¿è¡Œæ—¶åˆ¤æ–­å½“å‰å­åº”ç”¨è¿è¡Œçš„ç¯å¢ƒï¼Œä½¿ç”¨ä¸åŒçš„ <code>state</code></p><p>å­åº”ç”¨åˆ›å»ºä¸€ä¸ª <code>state</code> (å’Œä¸»åº”ç”¨çš„çŠ¶æ€ä¿æŒä¸€è‡´)</p><p>ğŸ‘‡ <code>src/models/xxx.js</code></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">useState</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">react</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">subAppModel</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">masterState</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">setMasterState</span><span style="color:#89DDFF;">]</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">useState</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    showFlag</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">false</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">masterState</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">setMasterState</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>ğŸ‘‡ å°è£…ä¸€ä¸ª <code>Hook</code> æ ¹æ®è¿è¡Œç¯å¢ƒæ“ä½œå¯¹åº”çš„ <code>state</code></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">useQianKun</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">@/utils/hooks</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">useModel</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">@umijs/max</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">useState</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">inqiankun</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">useQianKun</span><span style="color:#F07178;">() </span><span style="color:#676E95;font-style:italic;">// åˆ¤æ–­å­åº”ç”¨è¿è¡Œç¯å¢ƒ</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">stateModelNamespace</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">inqiankun</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">?</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@@qiankunStateFromMaster</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">xxx</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">useModel</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">stateModelNamespace</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>ğŸ‘‡ å­åº”ç”¨é¡µé¢ä½¿ç”¨</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> setMasterState </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">useState</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">setMasterState</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">showFlag</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div>`,52),e=[p];function t(c,r,F,y,D,i){return a(),n("div",null,e)}const d=s(o,[["render",t]]);export{C as __pageData,d as default};
