import{_ as s,o as n,c as a,V as p}from"./chunks/framework.b450deef.js";const d=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"articles/03-架构/设计/npm init原理.md","filePath":"articles/03-架构/设计/npm init原理.md"}'),o={name:"articles/03-架构/设计/npm init原理.md"},l=p(`<p>npm@6 版本引入了 <code>npm-init &lt;initializer&gt;</code> 语法，等价于 <code>npx create-&lt;initializer&gt;</code> 命令，而 <code>npx</code> 命令会去 <code>$PATH</code> 路径和 <code>node_modules/.bin</code> 路径下寻找名叫 <code>create-&lt;initializer&gt;</code> 的可执行文件，如果找到了就执行，找不到就去安装。</p><p>也就是说，<code>npm init egg</code> 会去寻找或下载 <code>create-egg</code> 可执行文件，而 <code>create-egg</code> 包就是 <code>egg-init</code> 包的别名，相当于调用了 <code>egg-init</code></p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">init</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">vue@next</span></span></code></pre></div><p>在习惯里，npm的脚手架依赖库工具都是通过全局安装依赖后，使用该库的指令进行搭建</p><p>如👇 vue-cli脚手架</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">i</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-g</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">@vue/cli</span></span>
<span class="line"><span style="color:#FFCB6B;">vue</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">hello-world</span></span></code></pre></div><p>而<code>npm init</code>则是给项目路径初始化出<code>package.json</code>文件，初始化项目目录的指令</p><p>为什么<code>npm init vue@next</code> 就可以安装脚手架依赖并运行脚手架搭建指令呢？</p><p>注意这里的<code>npm init xx</code> 不是安装依赖的指令<code>npm i xx</code> = <code>npm install xx</code></p><p>npm init 用法：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">init</span><span style="color:#A6ACCD;"> [--force</span><span style="color:#89DDFF;">|</span><span style="color:#FFCB6B;">-f</span><span style="color:#89DDFF;">|</span><span style="color:#FFCB6B;">--yes</span><span style="color:#89DDFF;">|</span><span style="color:#FFCB6B;">-y</span><span style="color:#89DDFF;">|</span><span style="color:#FFCB6B;">--scope]</span></span>
<span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">init</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">@scop</span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> (same </span><span style="color:#C3E88D;">as</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\`</span><span style="color:#FFCB6B;">npx</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">@scope</span><span style="color:#89DDFF;">&gt;</span><span style="color:#C3E88D;">/create</span><span style="color:#89DDFF;">\`</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">init</span><span style="color:#A6ACCD;"> [&lt;@scope&gt;/]</span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">same</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">as</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\`</span><span style="color:#FFCB6B;">npx</span><span style="color:#C3E88D;"> [&lt;@scope&gt;/]create-</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">name</span><span style="color:#89DDFF;">&gt;\`</span><span style="color:#89DDFF;">)</span></span></code></pre></div><ul><li><code>npm init xxx</code> -&gt; <code>npx create-xxx</code></li><li><code>npm init @xxx</code> -&gt; <code>npx @xxx/create</code></li><li><code>npm init @xxx/foo</code> -&gt; <code>npx @xxx/create-foo</code></li></ul><p>👆 @xx为命名空间，相当于一个依赖库的集合名称，而这些参数都会按照一定规则补充<code>create</code>名称</p><p>再来看这行指令<code>npm init vue@next</code>，需要注意到是依赖名后加<code>@xx</code>不是命名空间，而是指定版本 所以忽视安装依赖的版本则简化为 <code>npm init vue</code> 转化为<code>npx create-vue</code></p><p>而<a href="http://nodejs.cn/learn/the-npx-nodejs-package-runner" target="_blank" rel="noreferrer">npx指令</a>，不仅能直接运行<code>node_modules</code>中的库，还能不把依赖安装到本地来运行指令(估计是安装到了本地缓存，运行完自动清除那种) 如下官方示例</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">npx</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">cowsay</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">你好</span><span style="color:#89DDFF;">&quot;</span></span></code></pre></div><p>运行结果为</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">_______</span></span>
<span class="line"><span style="color:#A6ACCD;">&lt; 你好 &gt;</span></span>
<span class="line"><span style="color:#A6ACCD;"> -------</span></span>
<span class="line"><span style="color:#A6ACCD;">        \\   ^__^</span></span>
<span class="line"><span style="color:#A6ACCD;">         \\  (oo)\\_______</span></span>
<span class="line"><span style="color:#A6ACCD;">            (__)\\       )\\/\\</span></span>
<span class="line"><span style="color:#A6ACCD;">                ||----w |</span></span>
<span class="line"><span style="color:#A6ACCD;">                ||     ||</span></span></code></pre></div><p>这是<code>npx</code>安装<code>cowsay</code>的库并运行后的结果</p><p>到这里我们知道了<code>npm init vue@next</code> 就是本地执行<code>npx create-vue</code> 本地安装<code>create-vue</code>的脚手架库(不安装到本地而是安装到缓存并运行完清除),并运行的运行搭建指令</p><blockquote><p>另外，npx的这个不安装到本地的特性其实也可以用到vue-cli的脚手架框架</p><p>即 <code>npx @vue/cli create demoName</code></p><p>所以到这里并不能体现新的脚手架有多值得替换<code>npx create-vue</code></p></blockquote><h3 id="🤔-为什么有不同的命令来初始化项目" tabindex="-1">🤔 为什么有不同的命令来初始化项目 <a class="header-anchor" href="#🤔-为什么有不同的命令来初始化项目" aria-label="Permalink to &quot;🤔 为什么有不同的命令来初始化项目&quot;">​</a></h3><p>2个指令可以看出区别是 <code>init/create</code> 我们运行</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--help</span></span></code></pre></div><p>👇 得到</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">Usage:</span></span>
<span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">init</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">package-spe</span><span style="color:#A6ACCD;">c</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> (same </span><span style="color:#C3E88D;">as</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\`</span><span style="color:#FFCB6B;">npx</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">package-spec</span><span style="color:#89DDFF;">&gt;</span><span style="color:#C3E88D;">)</span></span>
<span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#C3E88D;"> init </span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">@scope</span><span style="color:#89DDFF;">&gt;</span><span style="color:#C3E88D;"> (same as </span><span style="color:#89DDFF;">\`</span><span style="color:#FFCB6B;">npx</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">@scop</span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">&gt;</span><span style="color:#C3E88D;">/create</span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">Options:</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#C3E88D;">-y</span><span style="color:#89DDFF;">|</span><span style="color:#C3E88D;">--yes</span><span style="color:#89DDFF;">]</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">[</span><span style="color:#C3E88D;">-f</span><span style="color:#89DDFF;">|</span><span style="color:#C3E88D;">--force</span><span style="color:#89DDFF;">]</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">[</span><span style="color:#C3E88D;">--scope </span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">@scope</span><span style="color:#89DDFF;">&gt;]</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#C3E88D;">-w</span><span style="color:#89DDFF;">|</span><span style="color:#C3E88D;">--workspace </span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">workspace-name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">[</span><span style="color:#C3E88D;">-w</span><span style="color:#89DDFF;">|</span><span style="color:#C3E88D;">--workspace </span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">workspace-name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#C3E88D;"> ...</span><span style="color:#89DDFF;">]]</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#C3E88D;">-ws</span><span style="color:#89DDFF;">|</span><span style="color:#C3E88D;">--workspaces</span><span style="color:#89DDFF;">]</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">[</span><span style="color:#C3E88D;">--no-workspaces-update</span><span style="color:#89DDFF;">]</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">[</span><span style="color:#C3E88D;">--include-workspace-root</span><span style="color:#89DDFF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">aliases:</span><span style="color:#C3E88D;"> create, innit</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">Run</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">npm help init</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> for more info</span></span></code></pre></div><p>👆 看出 <code>create</code> 是 <code>init</code> 的别名，并且指引详情文档也是打开 <code>init</code></p><p>因此 这里运行 <code>npm init vue@latest</code> === <code>npm create vue@latest</code></p><hr><p>👇 <a href="https://docs.npmjs.com/cli/v8/commands/npm-init" target="_blank" rel="noreferrer">npm init 官方文档</a></p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">init</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">foo</span><span style="color:#A6ACCD;"> -</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">exec</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">create-foo</span></span>
<span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">init</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">@usr/foo</span><span style="color:#A6ACCD;"> -</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">exec</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">@usr/create-foo</span></span>
<span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">init</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">@usr</span><span style="color:#A6ACCD;"> -</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">exec</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">@usr/create</span></span>
<span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">init</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">@usr@2.0.0</span><span style="color:#A6ACCD;"> -</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">exec</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">@usr/create@2.0.0</span></span>
<span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">init</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">@usr/foo@2.0.0</span><span style="color:#A6ACCD;"> -</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">exec</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">@usr/create-foo@2.0.0</span></span></code></pre></div><p>因此 <code>npm init vue@latest</code> 等同于👇</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">npx</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">create-vue@latest</span></span></code></pre></div>`,33),e=[l];function c(t,r,D,C,y,i){return n(),a("div",null,e)}const A=s(o,[["render",c]]);export{d as __pageData,A as default};
