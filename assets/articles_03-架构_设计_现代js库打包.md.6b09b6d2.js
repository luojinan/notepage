import{_ as s,o as e,c as a,V as o}from"./chunks/framework.b450deef.js";const y=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"articles/03-æ¶æ„/è®¾è®¡/ç°ä»£jsåº“æ‰“åŒ….md","filePath":"articles/03-æ¶æ„/è®¾è®¡/ç°ä»£jsåº“æ‰“åŒ….md"}'),n={name:"articles/03-æ¶æ„/è®¾è®¡/ç°ä»£jsåº“æ‰“åŒ….md"},p=o(`<p>package.json ä¸­çš„é…ç½®</p><h2 id="exports" tabindex="-1">exports <a class="header-anchor" href="#exports" aria-label="Permalink to &quot;exports&quot;">â€‹</a></h2><p><a href="https://nodejs.org/api/packages.html#package-entry-points" target="_blank" rel="noreferrer">Nodejså®˜æ–¹æ–‡æ¡£</a></p><blockquote><p>The <code>&quot;exports&quot;</code> provides a modern alternative to <code>&quot;main&quot;</code> allowing multiple entry points to be defined, conditional entry resolution support between environments, and preventing any other entry points besides those defined in <code>&quot;exports&quot;</code>.</p><p>exports é…ç½®æ˜¯æ›¿æ¢ main çš„ç°ä»£è¾“å‡ºé…ç½® ğŸ¤” ä»¥å¾€çš„ jsåº“ ä¸€èˆ¬éƒ½æ˜¯å®šä¹‰ main ä¸º UMD å—</p></blockquote><blockquote><p>the &quot;exports&quot; field is recommended. For packages supporting Node.js 10 and below, the &quot;main&quot; field is required. If both &quot;exports&quot; and &quot;main&quot; are defined, the &quot;exports&quot; field takes precedence over &quot;main&quot; in supported versions of Node.js.</p><p>ğŸ‘† ä½äºnodejs10 ä¸æ”¯æŒexports åªèƒ½ç”¨ main</p><p>å¯¹äºæ”¯æŒçš„nodejs export ä¼˜å…ˆçº§é«˜äº main</p></blockquote><blockquote><p>To make the introduction of &quot;exports&quot; non-breaking, ensure that every previously supported entry point is exported. It is best to explicitly specify entry points so that the package&#39;s public API is well-defined.</p><p>ğŸ‘† æ˜¾å¼å®šä¹‰å¯è¢«å¼•å…¥çš„ entry points æ˜¯æ›´å¥½çš„</p></blockquote><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">exports</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./index.js</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>ç­‰åŒäº</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">exports</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">.</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./index.js</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>ğŸ‘† <code>&quot;.&quot;</code> æ˜¯é»˜è®¤è¾“å‡ºå€¼ ä¹Ÿç­‰åŒäº <code>&quot;main&quot;</code> é…ç½®</p><h3 id="exportsçœç•¥åç¼€å†™æ³•" tabindex="-1">exportsçœç•¥åç¼€å†™æ³• <a class="header-anchor" href="#exportsçœç•¥åç¼€å†™æ³•" aria-label="Permalink to &quot;exportsçœç•¥åç¼€å†™æ³•&quot;">â€‹</a></h3><p><a href="https://github.com/WICG/import-maps#packages-via-trailing-slashes" target="_blank" rel="noreferrer">import map package - github</a></p><h3 id="exportså¸¸è§exportsé…ç½®" tabindex="-1">exportså¸¸è§exportsé…ç½® <a class="header-anchor" href="#exportså¸¸è§exportsé…ç½®" aria-label="Permalink to &quot;exportså¸¸è§exportsé…ç½®&quot;">â€‹</a></h3><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">exports</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">.</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F78C6C;">types</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">index.d.ts</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F78C6C;">module</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">index.js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F78C6C;">import</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">index.js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F78C6C;">require</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">index.cjs</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F78C6C;">default</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">index.js</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">./package.json</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./package.json</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>ğŸ‘† type module æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>nodejs æ–‡æ¡£åªæœ‰ <code>node-addons node import require default</code></p><ul><li>export <ul><li>åŠ¨è¯: è¾“å‡º</li><li>åè¯: å‡ºå£/å‡ºå£è´§ç‰© exports</li></ul></li><li>output <ul><li>åŠ¨è¯: è¾“å‡º</li><li>åè¯: äº§é‡/å‡ºå£é‡</li></ul></li></ul><p>æ ¹æ®ä¸åŒçš„æ¡ä»¶è¾“å‡ºå¯¹åº”çš„æ–‡ä»¶</p><ul><li>æ–‡ä»¶æ˜¯è¢« import è¿˜æ˜¯è¢« require</li><li>å¼€å‘äººå‘˜éœ€è¦çš„æ˜¯ development ç‰ˆæœ¬çš„åº“è¿˜æ˜¯ production ç‰ˆæœ¬</li></ul><h2 id="main" tabindex="-1">main <a class="header-anchor" href="#main" aria-label="Permalink to &quot;main&quot;">â€‹</a></h2><p><code>main</code> æ˜¯å½“æ‰“åŒ…å·¥å…·æˆ–è¿è¡Œæ—¶ä¸æ”¯æŒ package exports æ—¶çš„å…œåº•æ–¹æ¡ˆ</p><p>å¦‚æœæ‰“åŒ…å·¥å…·æˆ–è¿è¡Œæ—¶æ”¯æŒ package exportsï¼Œåˆ™ä¸ä¼šä½¿ç”¨ <code>main</code></p><p>â• æ˜¯ä¸ä¼šä½¿ç”¨, è€Œä¸ä»…ä»…æ˜¯ä¼˜å…ˆçº§</p><p><code>main</code> åº”è¯¥æŒ‡å‘ä¸€ä¸ªå…¼å®¹ CommonJS æ ¼å¼çš„äº§å‡ºï¼›å®ƒåº”è¯¥ä¸ package exports ä¸­çš„ <code>require</code> ä¿æŒä¸€è‡´ã€‚</p><h2 id="module" tabindex="-1">module <a class="header-anchor" href="#module" aria-label="Permalink to &quot;module&quot;">â€‹</a></h2><p><code>module</code> æ˜¯å½“ <code>æ‰“åŒ…å·¥å…·</code> æˆ–è¿è¡Œæ—¶ä¸æ”¯æŒ package exports æ—¶çš„å…œåº•æ–¹æ¡ˆ</p><p>å¦‚æœæ‰“åŒ…å·¥å…·æˆ–è¿è¡Œæ—¶æ”¯æŒ package exportsï¼Œåˆ™ä¸ä¼šä½¿ç”¨ <code>module</code>ã€‚</p><p><code>module</code> åº”è¯¥æŒ‡å‘ä¸€ä¸ªå…¼å®¹ ESM æ ¼å¼çš„äº§å‡ºï¼›å®ƒåº”è¯¥ä¸ package exports ä¸­çš„ <code>module</code> æˆ– <code>import</code> ä¿æŒä¸€è‡´ã€‚</p><h2 id="files" tabindex="-1">files <a class="header-anchor" href="#files" aria-label="Permalink to &quot;files&quot;">â€‹</a></h2><p>ç”¨äº npm å‘åŒ…</p><p><a href="https://docs.npmjs.com/cli/v8/configuring-npm/package-json#files" target="_blank" rel="noreferrer">files - npmå®˜æ–¹æ–‡æ¡£</a> å†³å®š <code>npm</code> CLI åœ¨æ‰“åŒ…åº“æ—¶å“ªäº›æ–‡ä»¶å’Œç›®å½•åŒ…å«åˆ°æœ€ç»ˆçš„ NPM åŒ…ä¸­ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœä½ å°†ä»£ç ä» TypeScript ç¼–è¯‘ä¸º JavaScriptï¼Œä½ å¯èƒ½å°±ä¸æƒ³åœ¨ NPM åŒ…ä¸­åŒ…å« TypeScript çš„æºä»£ç ã€‚ï¼ˆç›¸åï¼Œä½ åº”è¯¥åŒ…å« sourcemapï¼‰ã€‚</p><p><code>files</code> å¯ä»¥æ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼ˆå¦‚æœéœ€è¦ï¼Œè¿™äº›å­—ç¬¦ä¸²å¯ä»¥åŒ…å«ç±»ä¼¼ glob çš„è¯­æ³•ï¼‰ï¼Œä¾‹å¦‚ï¼š</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">files</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">dist</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>æ³¨æ„ï¼Œæ–‡ä»¶æ•°ç»„ä¸æ¥å—ç›¸å¯¹è·¯å¾„è¡¨ç¤ºï¼›<code>&quot;files&quot;: [&quot;./dist&quot;]</code> å°†æ— æ³•æ­£å¸¸å·¥ä½œã€‚</p><p>éªŒè¯ä½ å·²æ­£ç¡®è®¾ç½® <code>files</code> çš„ä¸€ç§å¥½æ–¹æ³•æ˜¯è¿è¡Œ <a href="https://docs.npmjs.com/cli/v8/commands/npm-publish#dry-run" target="_blank" rel="noreferrer"><code>npm publish --dry-run</code></a>ï¼Œå®ƒå°†æ ¹æ®æ­¤è®¾ç½®åˆ—å‡ºå°†ä¼šåŒ…å«çš„æ–‡ä»¶ã€‚</p><h2 id="types" tabindex="-1">types <a class="header-anchor" href="#types" aria-label="Permalink to &quot;types&quot;">â€‹</a></h2><p>package exports å¯ä»¥é…ç½® types</p><p>å¦‚æœæ‰“åŒ…å·¥å…·æˆ–è¿è¡Œæ—¶æ”¯æŒ package exportsï¼Œåˆ™ä¸ä¼šä½¿ç”¨ typesã€‚</p><p>types åº”è¯¥æŒ‡å‘ä½ çš„ TypeScript å…¥å£æ–‡ä»¶ï¼Œä¾‹å¦‚ index.d.tsï¼›å®ƒåº”è¯¥ä¸ package exports ä¸­çš„ types å­—æ®µæŒ‡å‘åŒä¸€ä¸ªæ–‡ä»¶ã€‚</p><h2 id="peerdependencies" tabindex="-1">peerDependencies <a class="header-anchor" href="#peerdependencies" aria-label="Permalink to &quot;peerDependencies&quot;">â€‹</a></h2><p>å¤–ç½®æ¡†æ¶ã€‚åªæœ‰åœ¨å¼€å‘äººå‘˜è‡ªè¡Œå®‰è£…ä½ éœ€è¦çš„æ¡†æ¶åæ‰èƒ½å·¥ä½œ</p><p>è®¾ç½® peerDependencies è®©ä»–ä»¬çŸ¥é“ä»–ä»¬éœ€è¦å®‰è£…çš„æ¡†æ¶ã€‚- ä¾‹å¦‚ï¼Œå¦‚æœä½ åœ¨åˆ›å»ºä¸€ä¸ª React åº“ï¼š</p><p>npm v3-v6 ä¸å®‰è£… peer dependenciesï¼Œè€Œ npm v7+ å°†è‡ªåŠ¨å®‰è£… peer dependenciesã€‚</p><h2 id="åŒåŒ…æ³¨æ„äº‹é¡¹" tabindex="-1">åŒåŒ…æ³¨æ„äº‹é¡¹ <a class="header-anchor" href="#åŒåŒ…æ³¨æ„äº‹é¡¹" aria-label="Permalink to &quot;åŒåŒ…æ³¨æ„äº‹é¡¹&quot;">â€‹</a></h2><p><a href="https://juejin.cn/post/6972006652631318564" target="_blank" rel="noreferrer">Nodeæœ€æ–°Moduleå¯¼å…¥å¯¼å‡ºè§„èŒƒ-ç¿»è¯‘Nodejså®˜æ–¹æ–‡æ¡£(Nodejs.cnå¤ªæœºç¿»äº†)</a></p><h2 id="ç®€æ˜“æ‰“åŒ…æ–¹æ³•" tabindex="-1">ç®€æ˜“æ‰“åŒ…æ–¹æ³• <a class="header-anchor" href="#ç®€æ˜“æ‰“åŒ…æ–¹æ³•" aria-label="Permalink to &quot;ç®€æ˜“æ‰“åŒ…æ–¹æ³•&quot;">â€‹</a></h2><h2 id="å‘åŒ…" tabindex="-1">å‘åŒ… <a class="header-anchor" href="#å‘åŒ…" aria-label="Permalink to &quot;å‘åŒ…&quot;">â€‹</a></h2><h2 id="å‚è€ƒèµ„æ–™" tabindex="-1">å‚è€ƒèµ„æ–™ <a class="header-anchor" href="#å‚è€ƒèµ„æ–™" aria-label="Permalink to &quot;å‚è€ƒèµ„æ–™&quot;">â€‹</a></h2><ul><li><a href="https://github.com/frehner/modern-guide-to-packaging-js-library/blob/main/README-zh_CN.md" target="_blank" rel="noreferrer">æ‰“åŒ… JavaScript åº“çš„ç°ä»£åŒ–æŒ‡å—</a></li></ul>`,50),l=[p];function t(r,c,i,d,D,u){return e(),a("div",null,l)}const h=s(n,[["render",t]]);export{y as __pageData,h as default};
